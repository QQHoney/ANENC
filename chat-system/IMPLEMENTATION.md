# ğŸš€ Serv00èŠå¤©ç³»ç»Ÿ - å®Œæ•´å®æ–½æŒ‡å—

## ğŸ“– é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ª**ä¸“ä¸ºServ00å…è´¹ä¸»æœºç¯å¢ƒä¼˜åŒ–**çš„å®æ—¶èŠå¤©ç³»ç»Ÿï¼Œæ”¯æŒçœŸå®ç”¨æˆ·æ³¨å†Œã€å¥½å‹ç³»ç»Ÿã€å®æ—¶æ¶ˆæ¯ä¼ é€’ã€é€šçŸ¥ç³»ç»Ÿç­‰å®Œæ•´åŠŸèƒ½ã€‚

**æ ¸å¿ƒä¼˜åŠ¿**:
- âœ… **å®Œå…¨å…è´¹** - ä»…ä½¿ç”¨Serv00å…è´¹èµ„æº
- âœ… **èµ„æºä¼˜åŒ–** - é’ˆå¯¹512MBå†…å­˜é™åˆ¶æ·±åº¦ä¼˜åŒ–
- âœ… **ç”Ÿäº§å°±ç»ª** - åŒ…å«ç›‘æ§ã€å¤‡ä»½ã€éƒ¨ç½²å®Œæ•´æ–¹æ¡ˆ
- âœ… **çœŸå®ç”¨æˆ·** - æ”¯æŒå®Œæ•´ç”¨æˆ·æ³¨å†Œã€è®¤è¯ã€ç¤¾äº¤åŠŸèƒ½

---

## ğŸ¯ å¿«é€Ÿå¼€å§‹ï¼ˆ3åˆ†é’Ÿï¼‰

### 1. ä¸‹è½½æ‰€æœ‰æ–‡ä»¶
```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd C:\Users\Administrator\Desktop\web\chat-system

# æ‰€æœ‰å¿…éœ€æ–‡ä»¶å·²å‡†å¤‡å°±ç»ªï¼š
# - README.md              é¡¹ç›®è¯´æ˜
# - package.json           ä¾èµ–é…ç½®
# - .env.example          ç¯å¢ƒå˜é‡æ¨¡æ¿
# - database-schema.sql   æ•°æ®åº“æ¶æ„
# - api-spec.md           APIæ–‡æ¡£
# - deployment-guide.md   éƒ¨ç½²æŒ‡å—
# - test-plan.md          æµ‹è¯•è®¡åˆ’
# - project-roadmap.md    é¡¹ç›®è·¯çº¿å›¾
# - quick-start.sh        å¿«é€Ÿéƒ¨ç½²è„šæœ¬
# - server.js             ä¸»æœåŠ¡å™¨ï¼ˆéœ€åˆ›å»ºï¼‰
# - ecosystem.config.js   PM2é…ç½®ï¼ˆéœ€åˆ›å»ºï¼‰
```

### 2. ä¸Šä¼ åˆ°Serv00
```bash
# ä½¿ç”¨FTPæˆ–SCPä¸Šä¼ æ‰€æœ‰æ–‡ä»¶åˆ°Serv00
# ç›®æ ‡è·¯å¾„: ~/domains/chat.yourdomain.com/app/

# ç¤ºä¾‹SCPå‘½ä»¤ï¼ˆWindows PowerShellï¼‰:
scp -r "C:\Users\Administrator\Desktop\web\chat-system\*" your_username@serv00.com:~/domains/chat.yourdomain.com/app/
```

### 3. åœ¨Serv00ä¸Šæ‰§è¡Œ
```bash
# SSHç™»å½•Serv00
ssh your_username@serv00.com

# è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/domains/chat.yourdomain.com/app/

# è¿è¡Œå¿«é€Ÿéƒ¨ç½²è„šæœ¬
bash quick-start.sh

# æŒ‰è„šæœ¬æç¤ºå®Œæˆåç»­æ­¥éª¤
```

---

## ğŸ“‹ å®Œæ•´å®æ–½æ­¥éª¤

### é˜¶æ®µ1ï¼šç¯å¢ƒå‡†å¤‡ï¼ˆ1å°æ—¶ï¼‰

#### 1.1 Serv00è´¦æˆ·è®¾ç½®
```bash
# 1. ç™»å½•Serv00æ§åˆ¶é¢æ¿
# 2. å¯ç”¨SSHè®¿é—®ï¼ˆå¦‚æœæœªå¯ç”¨ï¼‰
# 3. è®°å½•ä»¥ä¸‹ä¿¡æ¯ï¼š
#    - ç”¨æˆ·å: your_username
#    - å¯†ç : your_password
#    - åŸŸå: yourdomain.com æˆ– your_username.serv00.com
```

#### 1.2 åˆ›å»ºç›®å½•ç»“æ„
```bash
# SSHç™»å½•åæ‰§è¡Œ
mkdir -p ~/domains/chat.yourdomain.com/{app,public_html,logs,backups}
cd ~/domains/chat.yourdomain.com/app
```

#### 1.3 ä¸Šä¼ é¡¹ç›®æ–‡ä»¶
å°†æœ¬åœ° `C:\Users\Administrator\Desktop\web\chat-system\` ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ åˆ°Serv00çš„ `~/domains/chat.yourdomain.com/app/` ç›®å½•

#### 1.4 é…ç½®ç¯å¢ƒå˜é‡
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘é…ç½®ï¼ˆä½¿ç”¨nanoæˆ–viï¼‰
nano .env
```

**å¿…é¡»ä¿®æ”¹çš„é…ç½®**:
```env
DB_USER=your_serv00_username
DB_PASSWORD=your_mysql_password
JWT_SECRET=ç”Ÿæˆä¸€ä¸ªå¤æ‚çš„éšæœºå­—ç¬¦ä¸²
```

#### 1.5 åˆ›å»ºæ•°æ®åº“
```bash
# 1. ç™»å½•Serv00æ§åˆ¶é¢æ¿
# 2. æ‰¾åˆ°phpMyAdminé“¾æ¥
# 3. åˆ›å»ºæ–°æ•°æ®åº“: chat_system
# 4. å¯¼å…¥æ•°æ®åº“æ¶æ„: ä¸Šä¼ å¹¶å¯¼å…¥ database-schema.sql
```

### é˜¶æ®µ2ï¼šæ ¸å¿ƒå¼€å‘ï¼ˆ3-4å°æ—¶ï¼‰

#### 2.1 åˆ›å»ºä¸»æœåŠ¡å™¨æ–‡ä»¶
åœ¨Serv00ä¸Šåˆ›å»º `server.js`:

```bash
cat > server.js << 'EOF'
// ä» deployment-guide.md å¤åˆ¶å®Œæ•´ä»£ç 
// æˆ–ä½¿ç”¨ quick-start.sh è‡ªåŠ¨ç”Ÿæˆçš„ç®€åŒ–ç‰ˆæœ¬
EOF
```

#### 2.2 åˆ›å»ºPM2é…ç½®
```bash
cat > ecosystem.config.js << 'EOF'
// ä» deployment-guide.md å¤åˆ¶å®Œæ•´é…ç½®
EOF
```

#### 2.3 å®‰è£…ä¾èµ–
```bash
npm install
```

#### 2.4 æµ‹è¯•åŸºç¡€åŠŸèƒ½
```bash
# å¯åŠ¨æµ‹è¯•æœåŠ¡å™¨
node server.js

# åœ¨å¦ä¸€ä¸ªSSHçª—å£æµ‹è¯•
curl http://localhost:3000/health

# å¦‚æœçœ‹åˆ° {"status":"ok"} è¯´æ˜åŸºç¡€ç¯å¢ƒæ­£å¸¸
```

### é˜¶æ®µ3ï¼šåŠŸèƒ½å¼€å‘ï¼ˆ6-8å°æ—¶ï¼‰

æŒ‰ç…§ä»¥ä¸‹é¡ºåºå®ç°åŠŸèƒ½æ¨¡å—ï¼š

#### 3.1 ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- æ³¨å†Œ/ç™»å½•API
- JWT tokenç”Ÿæˆå’ŒéªŒè¯
- å¯†ç åŠ å¯†ï¼ˆbcryptï¼‰

#### 3.2 æˆ¿é—´ç®¡ç†ç³»ç»Ÿ
- åˆ›å»º/åŠ å…¥/ç¦»å¼€æˆ¿é—´
- æˆ¿é—´åˆ—è¡¨æŸ¥è¯¢
- æˆ¿é—´æˆå‘˜ç®¡ç†

#### 3.3 å®æ—¶æ¶ˆæ¯ç³»ç»Ÿ
- Socket.ioè¿æ¥ç®¡ç†
- æ¶ˆæ¯å‘é€/æ¥æ”¶
- æ¶ˆæ¯å†å²æŸ¥è¯¢
- åœ¨çº¿çŠ¶æ€åŒæ­¥

#### 3.4 å¥½å‹å’Œé€šçŸ¥ç³»ç»Ÿ
- å¥½å‹è¯·æ±‚ç®¡ç†
- å¥½å‹åˆ—è¡¨
- å®æ—¶é€šçŸ¥æ¨é€
- é€šçŸ¥å·²è¯»æ ‡è®°

### é˜¶æ®µ4ï¼šå‰ç«¯ç•Œé¢ï¼ˆ2-3å°æ—¶ï¼‰

#### 4.1 åˆ›å»ºåŸºç¡€HTMLç•Œé¢
ä½¿ç”¨ `public/index.html`ï¼ˆå·²åŒ…å«åœ¨å¿«é€Ÿéƒ¨ç½²ä¸­ï¼‰

#### 4.2 æ·»åŠ CSSæ ·å¼
åˆ›å»º `public/css/style.css`

#### 4.3 æ·»åŠ JavaScripté€»è¾‘
åˆ›å»º `public/js/app.js`

### é˜¶æ®µ5ï¼šæµ‹è¯•å’Œéƒ¨ç½²ï¼ˆ2-3å°æ—¶ï¼‰

#### 5.1 åŠŸèƒ½æµ‹è¯•
```bash
# è¿è¡Œæµ‹è¯•è„šæœ¬
npm test

# æˆ–æ‰‹åŠ¨æµ‹è¯•ï¼š
# 1. æ³¨å†Œæ–°ç”¨æˆ·
# 2. ç™»å½•è·å–token
# 3. åˆ›å»ºæˆ¿é—´
# 4. å‘é€æ¶ˆæ¯
# 5. éªŒè¯å®æ—¶é€šä¿¡
```

#### 5.2 æ€§èƒ½æµ‹è¯•
```bash
# æµ‹è¯•å¹¶å‘è¿æ¥
npm run test:performance

# ç›‘æ§èµ„æºä½¿ç”¨
pm2 monit
```

#### 5.3 ç”Ÿäº§éƒ¨ç½²
```bash
# ä½¿ç”¨PM2å¯åŠ¨
npm run pm2:start

# é…ç½®Apacheåå‘ä»£ç†
# ç¼–è¾‘ ~/domains/chat.yourdomain.com/public_html/.htaccess
```

---

## ğŸ› ï¸ å…³é”®æŠ€æœ¯å®ç°

### æ•°æ®åº“ä¼˜åŒ–ï¼ˆé’ˆå¯¹Serv00é™åˆ¶ï¼‰

```javascript
// config/database.js
const pool = mysql.createPool({
  host: process.env.DB_HOST,
  user: process.env.DB_USER,
  password: process.env.DB_PASSWORD,
  database: process.env.DB_NAME,
  connectionLimit: 5,  // ä¸¥æ ¼é™åˆ¶è¿æ¥æ•°
  queueLimit: 0,
  enableKeepAlive: true,
  keepAliveInitialDelay: 0
});
```

### Socket.ioä¼˜åŒ–

```javascript
// é™åˆ¶è¿æ¥å’Œç¼“å†²åŒº
const io = socketIo(server, {
  maxHttpBufferSize: 1e6,  // 1MBé™åˆ¶
  pingTimeout: 60000,
  pingInterval: 30000,
  cors: { origin: "*" }
});
```

### å†…å­˜ç®¡ç†

```javascript
// ä½¿ç”¨Mapè€Œéå¯¹è±¡å­˜å‚¨è¿æ¥
const activeConnections = new Map();
const roomUsers = new Map();

// å®šæœŸæ¸…ç†
setInterval(() => {
  // æ¸…ç†ä¸æ´»è·ƒè¿æ¥
}, 60000);
```

---

## ğŸ“Š æ€§èƒ½ç›®æ ‡å’Œé™åˆ¶

### Serv00èµ„æºé™åˆ¶
| èµ„æº | é™åˆ¶ | ä¼˜åŒ–ç­–ç•¥ |
|------|------|----------|
| CPU | 10-20% | é¿å…å¤æ‚è®¡ç®—ï¼Œä½¿ç”¨ç¼“å­˜ |
| å†…å­˜ | 512MB-1GB | é™åˆ¶è¿æ¥æ•°ï¼ŒåŠæ—¶é‡Šæ”¾èµ„æº |
| è¿›ç¨‹ | 3-5ä¸ª | å•è¿›ç¨‹ + PM2ç®¡ç† |
| å­˜å‚¨ | 5-10GB | å®šæœŸæ¸…ç†æ—¥å¿—å’Œå¤‡ä»½ |

### ç³»ç»Ÿæ€§èƒ½ç›®æ ‡
| æŒ‡æ ‡ | ç›®æ ‡å€¼ | æµ‹è¯•æ–¹æ³• |
|------|--------|----------|
| å¹¶å‘ç”¨æˆ· | 30-50äºº | å‹åŠ›æµ‹è¯• |
| æ¶ˆæ¯å»¶è¿Ÿ | < 200ms | ç«¯åˆ°ç«¯æµ‹è¯• |
| å†…å­˜ä½¿ç”¨ | < 400MB | PM2ç›‘æ§ |
| å¯ç”¨æ€§ | > 99% | 24å°æ—¶æµ‹è¯• |

---

## ğŸ”’ å®‰å…¨å®ç°

### 1. è®¤è¯å®‰å…¨
- JWT token + refreshæœºåˆ¶
- å¯†ç bcryptåŠ å¯†ï¼ˆ10è½®saltï¼‰
- Tokenè¿‡æœŸæ—¶é—´24å°æ—¶

### 2. è¾“å…¥éªŒè¯
```javascript
const { body, validationResult } = require('express-validator');

const registerValidation = [
  body('username').isLength({ min: 3, max: 20 }).trim().escape(),
  body('email').isEmail().normalizeEmail(),
  body('password').isLength({ min: 6 })
];
```

### 3. SQLæ³¨å…¥é˜²æŠ¤
```javascript
// ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
const query = 'SELECT * FROM users WHERE email = ?';
const [users] = await pool.execute(query, [email]);
```

### 4. XSSé˜²æŠ¤
```javascript
// æ¶ˆæ¯å†…å®¹æ¸…ç†
const cleanContent = content.replace(/[<>]/g, '');
```

### 5. é€Ÿç‡é™åˆ¶
```javascript
const rateLimit = require('express-rate-limit');

const limiter = rateLimit({
  windowMs: 60000,  // 1åˆ†é’Ÿ
  max: 30,          // æœ€å¤š30æ¬¡è¯·æ±‚
  message: 'è¯·æ±‚è¿‡äºé¢‘ç¹'
});
```

---

## ğŸ“ˆ ç›‘æ§å’Œç»´æŠ¤

### æ—¥å¸¸ç›‘æ§å‘½ä»¤
```bash
# æŸ¥çœ‹åº”ç”¨çŠ¶æ€
pm2 status

# å®æ—¶æ—¥å¿—
pm2 logs chat-server --lines 50

# èµ„æºç›‘æ§
pm2 monit

# æ•°æ®åº“è¿æ¥æ•°
mysql -u $DB_USER -p -e "SHOW PROCESSLIST;" chat_system

# ç£ç›˜ä½¿ç”¨
df -h ~/domains/
```

### è‡ªåŠ¨åŒ–ç»´æŠ¤
```bash
# æ·»åŠ åˆ°crontabï¼ˆå¦‚æœæ”¯æŒï¼‰
# æ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½
0 2 * * * cd ~/domains/chat.yourdomain.com/app && npm run backup

# æ¯å°æ—¶ç›‘æ§
0 * * * * cd ~/domains/chat.yourdomain.com/app && npm run monitor
```

---

## ğŸš¨ æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

**1. è¿›ç¨‹è¢«æ€æ­»**
```bash
# æ£€æŸ¥PM2çŠ¶æ€
pm2 status

# é‡å¯åº”ç”¨
pm2 restart chat-server

# æŸ¥çœ‹å†…å­˜ä½¿ç”¨
free -m
```

**2. æ•°æ®åº“è¿æ¥å¤±è´¥**
```bash
# æµ‹è¯•è¿æ¥
mysql -u $DB_USER -p -e "SELECT 1;" chat_system

# æ£€æŸ¥è¿æ¥æ•°
mysql -u $DB_USER -p -e "SHOW STATUS LIKE 'Threads_connected';"
```

**3. ç«¯å£å†²çª**
```bash
# æŸ¥æ‰¾è¿›ç¨‹
lsof -i :3000

# æ€æ­»è¿›ç¨‹
kill -9 <PID>
```

**4. å†…å­˜ä¸è¶³**
```bash
# æ¸…ç†å†…å­˜
sync; echo 3 > /proc/sys/vm/drop_caches

# é‡å¯åº”ç”¨é‡Šæ”¾å†…å­˜
pm2 restart chat-server
```

---

## ğŸ“ è·å–å¸®åŠ©

### æ–‡æ¡£èµ„æº
1. **README.md** - é¡¹ç›®æ¦‚è¿°å’Œå¿«é€Ÿå¼€å§‹
2. **deployment-guide.md** - è¯¦ç»†éƒ¨ç½²æ­¥éª¤
3. **api-spec.md** - å®Œæ•´APIæ–‡æ¡£
4. **test-plan.md** - æµ‹è¯•ç­–ç•¥å’Œç”¨ä¾‹
5. **project-roadmap.md** - å®æ–½æ—¶é—´è¡¨

### å…³é”®æ–‡ä»¶ä½ç½®
- **é…ç½®**: `.env`, `ecosystem.config.js`
- **æ•°æ®åº“**: `database-schema.sql`
- **API**: `api-spec.md`
- **éƒ¨ç½²**: `deployment-guide.md`, `quick-start.sh`

---

## âœ… éªŒæ”¶æ¸…å•

### éƒ¨ç½²å‰
- [ ] Serv00è´¦æˆ·å·²é…ç½®SSHè®¿é—®
- [ ] åŸŸåå·²è®¾ç½®ï¼ˆæˆ–ä½¿ç”¨serv00.comå­åŸŸåï¼‰
- [ ] MySQLæ•°æ®åº“å·²åˆ›å»º
- [ ] ç¯å¢ƒå˜é‡å·²é…ç½®
- [ ] æ‰€æœ‰æ–‡ä»¶å·²ä¸Šä¼ 

### éƒ¨ç½²å
- [ ] åº”ç”¨å¯ä»¥å¯åŠ¨å¹¶è¿è¡Œ
- [ ] å¥åº·æ£€æŸ¥APIè¿”å›æ­£å¸¸
- [ ] ç”¨æˆ·æ³¨å†Œ/ç™»å½•åŠŸèƒ½æ­£å¸¸
- [ ] Socketè¿æ¥æ­£å¸¸
- [ ] æ¶ˆæ¯å‘é€/æ¥æ”¶æ­£å¸¸
- [ ] PM2è¿›ç¨‹å®ˆæŠ¤æ­£å¸¸
- [ ] ç›‘æ§è„šæœ¬è¿è¡Œæ­£å¸¸
- [ ] å¤‡ä»½è„šæœ¬è¿è¡Œæ­£å¸¸

### ç”Ÿäº§å°±ç»ª
- [ ] æ€§èƒ½æµ‹è¯•é€šè¿‡
- [ ] å®‰å…¨æµ‹è¯•é€šè¿‡
- [ ] 24å°æ—¶ç¨³å®šæ€§æµ‹è¯•é€šè¿‡
- [ ] ç›‘æ§å‘Šè­¦é…ç½®å®Œæˆ
- [ ] å¤‡ä»½ç­–ç•¥ç”Ÿæ•ˆ

---

## ğŸ¯ æˆåŠŸæ ‡å‡†

### æŠ€æœ¯æŒ‡æ ‡
- âœ… ç³»ç»Ÿå¯ç”¨æ€§ > 99%
- âœ… å¹³å‡å“åº”æ—¶é—´ < 200ms
- âœ… æ¶ˆæ¯é€è¾¾ç‡ = 100%
- âœ… 24å°æ—¶æ— å´©æºƒ

### ç”¨æˆ·æŒ‡æ ‡
- âœ… æ”¯æŒ30+å¹¶å‘ç”¨æˆ·
- âœ… æ³¨å†Œ/ç™»å½•æµç¨‹é¡ºç•…
- âœ… å®æ—¶æ¶ˆæ¯æ— å»¶è¿Ÿ
- âœ… å¥½å‹/é€šçŸ¥åŠŸèƒ½å®Œæ•´

### è¿ç»´æŒ‡æ ‡
- âœ… è‡ªåŠ¨é‡å¯æœºåˆ¶æ­£å¸¸
- âœ… ç›‘æ§å‘Šè­¦æœ‰æ•ˆ
- âœ… å¤‡ä»½æ¢å¤å¯é 
- âœ… èµ„æºä½¿ç”¨åˆç†

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³æ‰§è¡Œ
1. **é˜…è¯»æ‰€æœ‰æ–‡æ¡£** - ç†è§£ç³»ç»Ÿæ¶æ„
2. **å‡†å¤‡Serv00ç¯å¢ƒ** - ç¡®ä¿è´¦æˆ·å°±ç»ª
3. **è¿è¡Œå¿«é€Ÿéƒ¨ç½²** - ä½¿ç”¨ `quick-start.sh`
4. **æµ‹è¯•åŸºç¡€åŠŸèƒ½** - éªŒè¯ç¯å¢ƒæ­£ç¡®

### å¼€å‘é˜¶æ®µ
1. **å®ç°æ ¸å¿ƒAPI** - æŒ‰APIæ–‡æ¡£é¡ºåº
2. **å¼€å‘SocketåŠŸèƒ½** - å®æ—¶é€šä¿¡
3. **åˆ›å»ºå‰ç«¯ç•Œé¢** - ç”¨æˆ·äº¤äº’
4. **ç¼–å†™æµ‹è¯•ç”¨ä¾‹** - ç¡®ä¿è´¨é‡

### éƒ¨ç½²é˜¶æ®µ
1. **æ€§èƒ½ä¼˜åŒ–** - é’ˆå¯¹Serv00é™åˆ¶
2. **å®‰å…¨åŠ å›º** - é˜²æŠ¤æµ‹è¯•
3. **ç”Ÿäº§éƒ¨ç½²** - PM2 + åå‘ä»£ç†
4. **ç›‘æ§ç»´æŠ¤** - æ—¥å¸¸è¿ç»´

---

**é¡¹ç›®çŠ¶æ€**: ğŸŸ¢ **å‡†å¤‡å°±ç»ª**
**æ‰€æœ‰æ–‡æ¡£å’Œé…ç½®æ–‡ä»¶å·²åˆ›å»º**
**ä¸‹ä¸€æ­¥ï¼šæŒ‰ç…§å®æ–½æŒ‡å—å¼€å§‹éƒ¨ç½²**